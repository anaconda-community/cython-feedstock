From dd49451b76567167db4c3d82097c8dc083b85587 Mon Sep 17 00:00:00 2001
From: mattip <matti.picus@gmail.com>
Date: Thu, 17 Jun 2021 20:39:09 +0300
Subject: [PATCH] tweak 1027db04 for older versions of PyPy

---
 Cython/Utility/Builtins.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Cython/Utility/Builtins.c b/Cython/Utility/Builtins.c
index c33c93de80..30b7145a45 100644
--- a/Cython/Utility/Builtins.c
+++ b/Cython/Utility/Builtins.c
@@ -78,7 +78,7 @@ static PyObject* __Pyx_PyExec3(PyObject* o, PyObject* globals, PyObject* locals)
                 "code object passed to exec() may not contain free variables");
             goto bad;
         }
-        #if PY_VERSION_HEX < 0x030200B1
+        #if PY_VERSION_HEX < 0x030200B1 || (CYTHON_COMPILING_IN_PYPY && PYPY_VERSION_NUM < 0x07030400)
         result = PyEval_EvalCode((PyCodeObject *)o, globals, locals);
         #else
         result = PyEval_EvalCode(o, globals, locals);

